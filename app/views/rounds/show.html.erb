<p id="notice"><%= notice %></p>

<div class="page-header">
  <h1><%= @round.tournament.name %> <small>Round #<%= @round.tournament_round_id %></small></h1>
</div>

<h3>Standings</h3>
<table class="table">
  <thead>
    <th>Position</th>
    <th>Player</th>
    <th>Points</th>
  </thead>
  <tbody>
    <% @standings.each do |standing| %>
    <tr>
      <td><%= standing.position %></td>
      <td><%= standing.player.given_name %></td>
      <td><%= standing.points %></td>
    </tr>
    <% end %>
  </tbody>
</table>

<% if can? :manage, @tournament %>
  <%= link_to 'Update standings', edit_tournament_round_path(@tournament, @round) %>
<% end %>

<h3>Games</h3>
<table class="table">
  <tr>
    <th>Date played</th>
    <th><span class="pull-right">White</span></th>
    <th></th>
    <th></th>
    <th>Black</th>
    <th></th>
    <% if can? :manage, @tournament %>
      <th></th>
      <th></th>
    <% end %>
  </tr>

<% @round.duels.each do |duel| %>
  <tr>
    <td><%= duel.created_at.strftime("%d-%m-%Y %H:%M") %></td>
    <td><span class="pull-right"><%= duel.white_player.given_name %></span></td>
    <td><span class="pull-right"><%= duel.white_result %></span></td>
    <td><%= duel.black_result %></td>
    <td><%= duel.black_player.given_name %></td>
    <td><%= link_to 'Show', tournament_round_duel_path(@tournament, @round, duel) %></td>
    <% if can? :manage, @tournament %>
      <td><%= link_to 'Edit', edit_tournament_round_duel_path(@tournament, @round, duel) %></td>
      <td><%= link_to 'Destroy', tournament_round_duel_path(@tournament, @round, duel), confirm: 'Are you sure?', method: :delete %></td>
    <% end %>
  </tr>
<% end %>
</table>


<% if can? :manage, @tournament %>
  <%= link_to 'Create new duel', new_tournament_round_duel_path(@tournament, @round) %> |
  <%= link_to 'Edit', edit_tournament_round_path(@tournament, @round) %> |
<% end %>
<%= link_to 'Back', tournament_path(@tournament) %>
